function e(){localStorage.setItem("dss",document.getElementById("dss").value);localStorage.setItem("min",document.getElementById("min").value);chrome.a.c({b:"updated"})}
function h(){for(var b=document.getElementById("history").options,a="",c=0;c<b.length;c++){var d=b[b.length-1-c];d.selected||(a+=d.value+":"+d.text+"\n")}a=a.substring(0,a.length-1);window.webkitRequestFileSystem(window.TEMPORARY,1048576,function(b){b.root.getFile("yttrack.txt",{create:!0},function(b){b.createWriter(function(b){var c=new Blob([a],{type:"text/plain"});b.onwriteend=function(){0===b.length?b.write(c):k()};b.truncate(0)},n)},n)},n)}
function p(){window.webkitRequestFileSystem(window.TEMPORARY,1048576,q,n)}
function q(b){b.root.getFile("yttrack.txt",{},function(b){for(var c=[],d=0;1001>d;d++)c[d]=[];b.file(function(b){var a=new FileReader;a.onloadend=function(){for(var b="",a=this.result.split("\n"),d=0;d<a.length;d++){for(var f=(r(a[d])%1001+1001)%1001,l=!0,g=0;g<c[f].length;g++)if(c[f][g]==a[d]){l=!1;break}l&&(f=c[f],f[f.length]=a[d],b+=a[d]+"\n")}for(;"\n"==b.substring(b.length-1);)b=b.substring(0,b.length-1);window.webkitRequestFileSystem(window.TEMPORARY,1048576,function(a){a.root.getFile("yttrack.txt",
{create:!0},function(a){a.createWriter(function(a){var c=new Blob([b],{type:"text/plain"});a.onwriteend=function(){0===a.length?a.write(c):k()};a.truncate(0)},n)},n)},n)};a.readAsText(b)},n)},n)}function s(){for(var b=document.getElementById("history").options,a=0;a<b.length;a++){var c=b[b.length-1-a];c.selected&&chrome.d.create({url:"https://www.youtube.com/watch"+c.value})}}function r(b){for(var a=5381,c=0,c=0;c<b.length;c++)a=(a<<5)+a+b.charCodeAt(c);return a}
function k(){window.webkitRequestFileSystem(window.TEMPORARY,1048576,t,n)}function t(b){b.root.getFile("yttrack.txt",{},function(a){a.file(function(a){var b=new FileReader;b.onloadend=function(a){for(var b="",c=this.result.split("\n"),d=0;d<c.length;d++)if(""!==c[c.length-1-d]){a=c[c.length-1-d];var m=a.search(":"),f=a.substring(0,m);a=a.substring(m+1);b+='<option value="'+f+'">'+a+"</option>\n"}document.getElementById("history").innerHTML=b};b.readAsText(a)},n)},n)}
function u(){for(var b=document.getElementById("history").options,a=0;a<b.length;a++){var c=b[b.length-1-a];c.selected&&chrome.a.c({b:"generate",url:c.value.substring(3)})}}
function n(b){var a="";switch(b.code){case FileError.QUOTA_EXCEEDED_ERR:a="QUOTA_EXCEEDED_ERR";break;case FileError.NOT_FOUND_ERR:a="NOT_FOUND_ERR";break;case FileError.SECURITY_ERR:a="SECURITY_ERR";break;case FileError.INVALID_MODIFICATION_ERR:a="INVALID_MODIFICATION_ERR";break;case FileError.INVALID_STATE_ERR:a="INVALID_STATE_ERR";break;default:a="Unknown Error"}chrome.a.c({b:"Error: "+a})}
document.addEventListener("DOMContentLoaded",function(){document.getElementById("save").addEventListener("click",e);document.getElementById("del").addEventListener("click",h);document.getElementById("clr").addEventListener("click",p);document.getElementById("open").addEventListener("click",s);document.getElementById("dl").addEventListener("click",u);window.addEventListener("keydown",function(b){46===b.keyCode&&h()});document.getElementById("dss").value=localStorage.getItem("dss");document.getElementById("min").value=
localStorage.getItem("min");k()});
