(function(k){function f(){return{type:48,children:Array.prototype.slice.call(arguments)}}function m(d,b){function f(e){var b=d.charCodeAt(a++),c;c=d.charCodeAt(a++);if(c&128){var g=c&127;if(2<g||0==g)throw"Unsupported length";for(var l=c=0;l<g;l++)c+=d.charCodeAt(a++)<<8*(g-1-l)}if("type"in e&&e.type!=b)throw"Unexpected type";if("content"in e&&e.content!=d.substr(a,c))throw"Unexpected content";"out"in e&&(h[e.a]=new BigInteger(d.substr(a,c),256));if("children"in e){b=0;for(c=a+c;a<c;b++){if(b>=e.children.length)throw"Too many children";
f(e.children[b])}if(b<e.children.length)throw"Too few children";if(a>c)throw"Children too large";}else if("encapsulates"in e){if(0!=d.charCodeAt(a++))throw"Encapsulation expected";f(e.c)}else a+=c}var a=0,h={};f(b);if(a!=d.length)throw"Too much data";return h}var n=f(f({type:6,content:"*\u0086H\u0086\u00f7\r\u0001\u0001\u0001"},{}),{type:3,c:f({type:2,a:"n"},{type:2,a:"e"})}),p=f(f({type:6,content:"+\u000e\u0003\u0002\u001a"},{}),{type:4,a:"sha1"});k.h=function(d,b,f){var a;try{a=m(atob(d),n)}catch(h){console.log("Invalid RSA public key: "+
h),a=null}if(!a)return!1;a.b=parseInt(a.b.toString(16),16);d=(new BigInteger(atob(b),256)).e(a.b,a.f).toString(256);try{b=0;if(1!=d.charCodeAt(b++))throw"Wrong padding in signature digest";for(;255==d.charCodeAt(b++););if(0!=d.charCodeAt(b-1))throw"Wrong padding in signature digest";var e=m(d.substr(b),p).g,k=new BigInteger(SHA1(f),16);return 0==e.d(k)}catch(c){return console.log("Invalid encrypted signature: "+c),!1}}})(this);
